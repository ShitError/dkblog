(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-70ff1248"],{1090:function(t,i,e){},"1a25":function(t,i,e){"use strict";var s=e("3d71");e.n(s).a},"1cda":function(t,i,e){"use strict";var s=e("34eb");e.n(s).a},"34eb":function(t,i,e){},"3d71":function(t,i,e){},"4ea3":function(t,i,e){"use strict";e("4160"),e("c975"),e("a9e3"),e("ac1f"),e("5319"),e("1276"),e("498a"),e("159b");var s=e("2909"),n={"[开心]":"https://static.jishudaniu.com/emoji/1.gif","[难受]":"https://static.jishudaniu.com/emoji/2.gif","[好色]":"https://static.jishudaniu.com/emoji/3.gif","[呆]":"https://static.jishudaniu.com/emoji/4.gif","[大哭]":"https://static.jishudaniu.com/emoji/5.gif","[眨眼]":"https://static.jishudaniu.com/emoji/6.gif","[闭嘴]":"https://static.jishudaniu.com/emoji/7.gif","[Zzz]":"https://static.jishudaniu.com/emoji/8.gif","[伤心]":"https://static.jishudaniu.com/emoji/9.gif","[尴尬]":"https://static.jishudaniu.com/emoji/10.gif","[发怒]":"https://static.jishudaniu.com/emoji/11.gif","[俏皮]":"https://static.jishudaniu.com/emoji/12.gif","[嘻嘻]":"https://static.jishudaniu.com/emoji/13.gif","[惊讶]":"https://static.jishudaniu.com/emoji/14.gif","[沮丧]":"https://static.jishudaniu.com/emoji/15.gif","[害羞]":"https://static.jishudaniu.com/emoji/16.gif","[抓狂]":"https://static.jishudaniu.com/emoji/17.gif","[rua]":"https://static.jishudaniu.com/emoji/18.gif","[偷笑]":"https://static.jishudaniu.com/emoji/19.gif","[脸红]":"https://static.jishudaniu.com/emoji/20.gif","[白眼]":"https://static.jishudaniu.com/emoji/21.gif","[傲慢]":"https://static.jishudaniu.com/emoji/22.gif","[饥饿]":"https://static.jishudaniu.com/emoji/23.gif","[困]":"https://static.jishudaniu.com/emoji/24.gif","[害怕]":"https://static.jishudaniu.com/emoji/25.gif","[汗]":"https://static.jishudaniu.com/emoji/26.gif","[点头]":"https://static.jishudaniu.com/emoji/27.gif","[拽]":"https://static.jishudaniu.com/emoji/28.gif","[奋斗]":"https://static.jishudaniu.com/emoji/29.gif","[疑惑]":"https://static.jishudaniu.com/emoji/31.gif","[嘘]":"https://static.jishudaniu.com/emoji/32.gif","[倒霉]":"https://static.jishudaniu.com/emoji/35.gif","[敲头]":"https://static.jishudaniu.com/emoji/36.gif","[挥手]":"https://static.jishudaniu.com/emoji/37.gif","[擦汗]":"https://static.jishudaniu.com/emoji/38.gif","[抠鼻]":"https://static.jishudaniu.com/emoji/39.gif","[糗大了":"https://static.jishudaniu.com/emoji/40.gif","[坏笑]":"https://static.jishudaniu.com/emoji/41.gif","[左哼哼]":"https://static.jishudaniu.com/emoji/42.gif","[右哼哼]":"https://static.jishudaniu.com/emoji/43.gif","[哈欠]":"https://static.jishudaniu.com/emoji/44.gif","[鄙视]":"https://static.jishudaniu.com/emoji/45.gif","[纠结]":"https://static.jishudaniu.com/emoji/46.gif","[快哭了]":"https://static.jishudaniu.com/emoji/47.gif","[阴险]":"https://static.jishudaniu.com/emoji/48.gif","[亲亲]":"https://static.jishudaniu.com/emoji/49.gif","[吓]":"https://static.jishudaniu.com/emoji/50.gif","[可怜]":"https://static.jishudaniu.com/emoji/51.gif","[抱抱]":"https://static.jishudaniu.com/emoji/52.gif","[月亮]":"https://static.jishudaniu.com/emoji/53.gif","[太阳]":"https://static.jishudaniu.com/emoji/54.gif","[炸弹]":"https://static.jishudaniu.com/emoji/55.gif","[骷髅]":"https://static.jishudaniu.com/emoji/56.gif","[菜刀]":"https://static.jishudaniu.com/emoji/57.gif","[猪头]":"https://static.jishudaniu.com/emoji/58.gif","[西瓜]":"https://static.jishudaniu.com/emoji/59.gif","[咖啡]":"https://static.jishudaniu.com/emoji/60.gif","[米饭]":"https://static.jishudaniu.com/emoji/61.gif","[爱心]":"https://static.jishudaniu.com/emoji/62.gif","[赞]":"https://static.jishudaniu.com/emoji/63.gif","[踩]":"https://static.jishudaniu.com/emoji/64.gif","[握手]":"https://static.jishudaniu.com/emoji/65.gif","[耶]":"https://static.jishudaniu.com/emoji/66.gif","[抱拳]":"https://static.jishudaniu.com/emoji/67.gif","[勾引]":"https://static.jishudaniu.com/emoji/68.gif","[ok]":"https://static.jishudaniu.com/emoji/69.gif","[no]":"https://static.jishudaniu.com/emoji/70.gif","[玫瑰]":"https://static.jishudaniu.com/emoji/71.gif","[萎了]":"https://static.jishudaniu.com/emoji/72.gif","[红唇]":"https://static.jishudaniu.com/emoji/73.gif","[爱爱]":"https://static.jishudaniu.com/emoji/74.gif","[单身]":"https://static.jishudaniu.com/emoji/75.gif"},a={props:{chooseEmoji:{type:Boolean}},data:function(){return{emojiList:n}},methods:{addEmoji:function(t){this.$emit("addEmoji",t)}}},o=(e("1cda"),e("2877")),c=e("6544"),r=e.n(c),m=e("adda"),u=Object(o.a)(a,(function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{directives:[{name:"show",rawName:"v-show",value:t.chooseEmoji,expression:"chooseEmoji"}],staticClass:"emoji-wrapper"},t._l(t.emojiList,(function(i,s,n){return e("span",{key:n,staticClass:"emoji-item",on:{click:function(i){return t.addEmoji(s)}}},[e("v-img",{staticClass:"emoji",attrs:{"lazy-src":i,src:i,title:s,width:"24",height:"24"}})],1)})),0)}),[],!1,null,"758e8751",null),l=u.exports;r()(u,{VImg:m.a});var h={components:{Emoji:l},data:function(){return{index:0,chooseEmoji:!1,nickname:"",replyUserId:null,parentId:null,commentContent:""}},methods:{cancleReply:function(){this.$refs.reply.style.display="none"},insertReply:function(){var t=this;if(!this.$store.state.userId)return this.$store.state.loginFlag=!0,!1;if(""==this.commentContent.trim())return this.$toast({type:"error",message:"回复不能为空"}),!1;this.commentContent=this.commentContent.replace(/\[.+?\]/g,(function(t){return"<img src= '"+n[t]+"' width='22'height='20' style='padding: 0 1px'/>"}));var i={articleId:this.$route.path.split("/")[2],replyUserId:this.replyUserId,parentId:this.parentId,commentContent:this.commentContent};this.commentContent="",this.axios.post("/api/comments",i).then((function(i){var e=i.data;e.flag?(t.$emit("reloadReply",t.index),t.$toast({type:"success",message:"回复成功"})):t.$toast({type:"error",message:e.message})}))},addEmoji:function(t){this.commentContent+=t}}},p=(e("81c3"),Object(o.a)(h,(function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{ref:"reply",staticClass:"reply-input-wrapper",staticStyle:{display:"none"}},[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.commentContent,expression:"commentContent"}],staticClass:"comment-textarea",attrs:{placeholder:"回复 @"+t.nickname+"：","auto-grow":"",dense:""},domProps:{value:t.commentContent},on:{input:function(i){i.target.composing||(t.commentContent=i.target.value)}}}),t._v(" "),e("div",{staticClass:"emoji-container"},[e("span",{class:t.chooseEmoji?"emoji-btn-active":"emoji-btn",on:{click:function(i){t.chooseEmoji=!t.chooseEmoji}}},[e("i",{staticClass:"iconfont icon-biaoqian-"})]),e("div",{staticStyle:{"margin-left":"auto"}},[e("button",{staticClass:"cancle-btn v-comment-btn",on:{click:t.cancleReply}},[t._v(" 取消 ")]),e("button",{staticClass:"upload-btn v-comment-btn",on:{click:t.insertReply}},[t._v(" 提交 ")])])]),e("emoji",{attrs:{chooseEmoji:t.chooseEmoji},on:{addEmoji:t.addEmoji}})],1)}),[],!1,null,"c9481596",null).exports),d={props:{totalPage:{type:Number},index:{type:Number},commentId:{type:Number}},data:function(){return{current:1}},methods:{changeReplyCurrent:function(t){this.current=t,this.$emit("changeReplyCurrent",this.current,this.index,this.commentId)},prePage:function(){this.current-=1,this.$emit("changeReplyCurrent",this.current,this.index,this.commentId)},nextPage:function(){this.current+=1,this.$emit("changeReplyCurrent",this.current,this.index,this.commentId)}},computed:{isActive:function(){return function(t){if(t==this.current)return"active"}}}},f=(e("1a25"),{components:{Reply:p,Emoji:l,Paging:Object(o.a)(d,(function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"paging"},[e("a",{directives:[{name:"show",rawName:"v-show",value:1!=t.current,expression:"current != 1"}],staticClass:"ml-1 mr-1",on:{click:t.prePage}},[t._v("上一页")]),t.totalPage<6?t._l(t.totalPage,(function(i){return e("a",{key:i,class:"ml-1 mr-1 "+t.isActive(i),on:{click:function(e){return t.changeReplyCurrent(i)}}},[t._v(" "+t._s(i)+" ")])})):t.current<3?[t._l(4,(function(i){return e("a",{key:i,class:"ml-1 mr-1 "+t.isActive(i),on:{click:function(e){return t.changeReplyCurrent(i)}}},[t._v(" "+t._s(i)+" ")])})),e("span",{staticClass:"ml-1 mr-1"},[t._v("···")]),e("a",{staticClass:"ml-1 mr-1",on:{click:function(i){return t.changeReplyCurrent(t.totalPage)}}},[t._v(" "+t._s(t.totalPage)+" ")])]:t.current<5?[t._l(t.current+2,(function(i){return e("a",{key:i,class:"ml-1 mr-1 "+t.isActive(i),on:{click:function(e){return t.changeReplyCurrent(i)}}},[t._v(" "+t._s(i)+" ")])})),t.current+2<t.totalPage-1?e("span",{staticClass:"ml-1 mr-1"},[t._v("···")]):t._e(),t.current+2<t.totalPage?e("a",{staticClass:"ml-1 mr-1",on:{click:function(i){return t.changeReplyCurrent(t.totalPage)}}},[t._v(" "+t._s(t.totalPage)+" ")]):t._e()]:t.current>t.totalPage-2?[e("a",{staticClass:"ml-1 mr-1",on:{click:function(i){return t.changeReplyCurrent(1)}}},[t._v("1")]),e("span",{staticClass:"ml-1 mr-1"},[t._v("···")]),t._l(4,(function(i){return e("a",{key:i,class:"ml-1 mr-1 "+t.isActive(i+(t.totalPage-4)),on:{click:function(e){t.changeReplyCurrent(i+(t.totalPage-4))}}},[t._v(" "+t._s(i+(t.totalPage-4))+" ")])}))]:t.current>t.totalPage-4?[e("a",{staticClass:"ml-1 mr-1",on:{click:function(i){return t.changeReplyCurrent(1)}}},[t._v("1")]),e("span",{staticClass:"ml-1 mr-1"},[t._v("···")]),t._l(t.totalPage-t.current+3,(function(i){return e("a",{key:i,class:"ml-1 mr-1 "+t.isActive(i+t.current-3),on:{click:function(e){return t.changeReplyCurrent(i+t.current-3)}}},[t._v(" "+t._s(i+t.current-3)+" ")])}))]:[e("a",{staticClass:"ml-1 mr-1",on:{click:function(i){return t.changeReplyCurrent(1)}}},[t._v("1")]),e("span",{staticClass:"ml-1 mr-1"},[t._v("···")]),e("a",{staticClass:"ml-1 mr-1",on:{click:function(i){return t.changeReplyCurrent(t.current-2)}}},[t._v(" "+t._s(t.current-2)+" ")]),e("a",{staticClass:"ml-1 mr-1",on:{click:function(i){return t.changeReplyCurrent(t.current-1)}}},[t._v(" "+t._s(t.current-1)+" ")]),e("a",{staticClass:"active ml-1 mr-1"},[t._v(t._s(t.current))]),e("a",{staticClass:"ml-1 mr-1",on:{click:function(i){return t.changeReplyCurrent(t.current+1)}}},[t._v(" "+t._s(t.current+1)+" ")]),e("a",{staticClass:"ml-1 mr-1",on:{click:function(i){return t.changeReplyCurrent(t.current+2)}}},[t._v(" "+t._s(t.current+2)+" ")]),e("span",{staticClass:"ml-1 mr-1"},[t._v("···")]),e("a",{staticClass:"ml-1 mr-1",on:{click:function(i){return t.changeReplyCurrent(t.totalPage)}}},[t._v(t._s(t.totalPage))])],e("a",{directives:[{name:"show",rawName:"v-show",value:t.current!=t.totalPage,expression:"current != totalPage"}],staticClass:"ml-1 mr-1",on:{click:t.nextPage}},[t._v(" 下一页 ")])],2)}),[],!1,null,"5811e27a",null).exports},props:{commentList:{type:Array},count:{type:Number}},data:function(){return{reFresh:!0,commentContent:"",chooseEmoji:!1,current:1}},methods:{replyComment:function(t,i){this.$refs.reply.forEach((function(t){t.$el.style.display="none"})),this.$refs.reply[t].commentContent="",this.$refs.reply[t].nickname=i.nickname,this.$refs.reply[t].replyUserId=i.userId,this.$refs.reply[t].parentId=this.commentList[t].id,this.$refs.reply[t].chooseEmoji=!1,this.$refs.reply[t].index=t,this.$refs.reply[t].$el.style.display="block"},addEmoji:function(t){this.commentContent+=t},checkReplies:function(t,i){var e=this;this.axios.get("/api/comments/"+i.id+"/replies",{params:{current:1,size:5}}).then((function(s){var n=s.data;e.$refs.check[t].style.display="none",i.replyDTOList=n.data,Math.ceil(i.replyCount/5)>1&&(e.$refs.paging[t].style.display="flex")}))},changeReplyCurrent:function(t,i,e){var s=this;this.axios.get("/api/comments/"+e+"/replies",{params:{current:t,size:5}}).then((function(t){var e=t.data;s.commentList[i].replyDTOList=e.data}))},listComments:function(){var t=this;this.current++;var i=this.$route.path.split("/");this.axios.get("/api/comments",{params:{current:this.current,articleId:i[2]}}).then((function(i){var e,n=i.data;(e=t.commentList).push.apply(e,Object(s.a)(n.data.recordList))}))},insertComment:function(){var t=this;if(!this.$store.state.userId)return this.$store.state.loginFlag=!0,!1;if(""==this.commentContent.trim())return this.$toast({type:"error",message:"评论不能为空"}),!1;this.commentContent=this.commentContent.replace(/\[.+?\]/g,(function(t){return"<img src= '"+n[t]+"'width='24'height='24' style='padding: 0 1px'/>"}));var i={articleId:this.$route.path.split("/")[2],commentContent:this.commentContent};this.commentContent="",this.axios.post("/api/comments",i).then((function(i){var e=i.data;e.flag?(t.$emit("reloadComment"),t.$store.state.blogInfo.websiteConfig.isCommentReview?t.$toast({type:"warnning",message:"评论成功，正在审核中"}):t.$toast({type:"success",message:"评论成功"})):t.$toast({type:"error",message:e.message})}))},like:function(t){var i=this;if(!this.$store.state.userId)return this.$store.state.loginFlag=!0,!1;this.axios.post("/api/comments/"+t.id+"/like").then((function(e){e.data.flag&&(-1!=i.$store.state.commentLikeSet.indexOf(t.id)?i.$set(t,"likeCount",t.likeCount-1):i.$set(t,"likeCount",t.likeCount+1),i.$store.commit("commentLike",t.id))}))},reloadReply:function(t){var i=this;this.axios.get("/api/comments/"+this.commentList[t].id+"/replies",{params:{current:this.$refs.page[t].current}}).then((function(e){var s=e.data;i.commentList[t].replyCount++,i.commentList[t].replyCount>5&&(i.$refs.paging[t].style.display="flex"),i.$refs.check[t].style.display="none",i.$refs.reply[t].$el.style.display="none",i.commentList[t].replyDTOList=s.data}))}},computed:{isLike:function(){return function(t){return-1!=this.$store.state.commentLikeSet.indexOf(t)?"like-active":"like"}}},watch:{commentList:function(){var t=this;this.reFresh=!1,this.$nextTick((function(){t.reFresh=!0}))}}}),g=(e("fe09"),e("8212")),j=e("8336"),v=Object(o.a)(f,(function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",[t._m(0),e("div",{staticClass:"comment-input-wrapper"},[e("div",{staticStyle:{display:"flex"}},[e("v-avatar",{attrs:{size:"40"}},[this.$store.state.avatar?e("img",{attrs:{src:this.$store.state.avatar}}):e("img",{attrs:{src:this.$store.state.blogInfo.websiteConfig.touristAvatar}})]),e("div",{staticClass:"ml-3",staticStyle:{width:"100%"}},[e("div",{staticClass:"comment-input"},[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.commentContent,expression:"commentContent"}],staticClass:"comment-textarea",attrs:{placeholder:"留下点什么吧...","auto-grow":"",dense:""},domProps:{value:t.commentContent},on:{input:function(i){i.target.composing||(t.commentContent=i.target.value)}}})]),e("div",{staticClass:"emoji-container"},[e("span",{class:t.chooseEmoji?"emoji-btn-active":"emoji-btn",on:{click:function(i){t.chooseEmoji=!t.chooseEmoji}}},[e("i",{staticClass:"iconfont icon-biaoqing"})]),e("button",{staticClass:"upload-btn v-comment-btn",staticStyle:{"margin-left":"auto"},on:{click:t.insertComment}},[t._v(" 提交 ")])]),e("emoji",{attrs:{chooseEmoji:t.chooseEmoji},on:{addEmoji:t.addEmoji}})],1)],1)]),t.count>0&&t.reFresh?e("div",[e("div",{staticClass:"count"},[t._v(t._s(t.count)+" 评论")]),t._l(t.commentList,(function(i,s){return e("div",{key:i.id,staticClass:"pt-5",staticStyle:{display:"flex"}},[e("v-avatar",{staticClass:"comment-avatar",attrs:{size:"40"}},[e("img",{attrs:{src:i.avatar}})]),e("div",{staticClass:"comment-meta"},[e("div",{staticClass:"comment-user"},[i.webSite?e("a",{attrs:{href:i.webSite,target:"_blank"}},[t._v(" "+t._s(i.nickname)+" ")]):e("span",[t._v(t._s(i.nickname))]),1==i.userId?e("span",{staticClass:"blogger-tag"},[t._v("博主")]):t._e()]),e("div",{staticClass:"comment-info"},[e("span",{staticStyle:{"margin-right":"10px"}},[t._v(t._s(t.count-s)+"楼")]),e("span",{staticStyle:{"margin-right":"10px"}},[t._v(t._s(t._f("date")(i.createTime)))]),e("span",{class:t.isLike(i.id)+" iconfont icon-dianzan",on:{click:function(e){return t.like(i)}}}),e("span",{directives:[{name:"show",rawName:"v-show",value:i.likeCount>0,expression:"item.likeCount > 0"}]},[t._v(" "+t._s(i.likeCount))]),e("span",{staticClass:"reply-btn",on:{click:function(e){return t.replyComment(s,i)}}},[t._v(" 回复 ")])]),e("p",{staticClass:"comment-content",domProps:{innerHTML:t._s(i.commentContent)}}),t._l(i.replyDTOList,(function(n){return e("div",{key:n.id,staticStyle:{display:"flex"}},[e("v-avatar",{staticClass:"comment-avatar",attrs:{size:"36"}},[e("img",{attrs:{src:n.avatar}})]),e("div",{staticClass:"reply-meta"},[e("div",{staticClass:"comment-user"},[n.webSite?e("a",{attrs:{href:n.webSite,target:"_blank"}},[t._v(" "+t._s(n.nickname)+" ")]):e("span",[t._v(t._s(n.nickname))]),1==n.userId?e("span",{staticClass:"blogger-tag"},[t._v("博主")]):t._e()]),e("div",{staticClass:"comment-info"},[e("span",{staticStyle:{"margin-right":"10px"}},[t._v(" "+t._s(t._f("date")(n.createTime))+" ")]),e("span",{class:t.isLike(n.id)+" iconfont icon-dianzan",on:{click:function(i){return t.like(n)}}}),e("span",{directives:[{name:"show",rawName:"v-show",value:n.likeCount>0,expression:"reply.likeCount > 0"}]},[t._v(" "+t._s(n.likeCount))]),e("span",{staticClass:"reply-btn",on:{click:function(i){return t.replyComment(s,n)}}},[t._v(" 回复 ")])]),e("p",{staticClass:"comment-content"},[n.replyUserId!=i.userId?[n.replyWebSite?e("a",{staticClass:"comment-nickname ml-1",attrs:{href:n.replyWebSite,target:"_blank"}},[t._v(" @"+t._s(n.replyNickname)+" ")]):e("span",{staticClass:"ml-1"},[t._v(" @"+t._s(n.replyNickname)+" ")]),t._v(" ， ")]:t._e(),e("span",{domProps:{innerHTML:t._s(n.commentContent)}})],2)])],1)})),e("div",{directives:[{name:"show",rawName:"v-show",value:i.replyCount>3,expression:"item.replyCount > 3"}],ref:"check",refInFor:!0,staticClass:"mb-3",staticStyle:{"font-size":"0.75rem",color:"#6d757a"}},[t._v(" 共 "),e("b",[t._v(t._s(i.replyCount))]),t._v(" 条回复， "),e("span",{staticStyle:{color:"#00a1d6",cursor:"pointer"},on:{click:function(e){return t.checkReplies(s,i)}}},[t._v(" 点击查看 ")])]),e("div",{ref:"paging",refInFor:!0,staticClass:"mb-3",staticStyle:{"font-size":"0.75rem",color:"#222",display:"none"}},[e("span",{staticStyle:{"padding-right":"10px"}},[t._v(" 共"+t._s(Math.ceil(i.replyCount/5))+"页 ")]),e("paging",{ref:"page",refInFor:!0,attrs:{totalPage:Math.ceil(i.replyCount/5),index:s,commentId:i.id},on:{changeReplyCurrent:t.changeReplyCurrent}})],1),e("Reply",{ref:"reply",refInFor:!0,on:{reloadReply:t.reloadReply}})],2)],1)})),e("div",{staticClass:"load-wrapper"},[t.count>t.commentList.length?e("v-btn",{attrs:{outlined:""},on:{click:t.listComments}},[t._v(" 加载更多... ")]):t._e()],1)],2):e("div",{staticStyle:{padding:"1.25rem","text-align":"center"}},[t._v(" 来发评论吧~ ")])])}),[function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"comment-title"},[e("i",{staticClass:"iconfont icon-pinglun"}),t._v("评论")])}],!1,null,"557c20e1",null);i.a=v.exports;r()(v,{VAvatar:g.a,VBtn:j.a})},"57e8":function(t,i,e){},"81c3":function(t,i,e){"use strict";var s=e("1090");e.n(s).a},fe09:function(t,i,e){"use strict";var s=e("57e8");e.n(s).a}}]);